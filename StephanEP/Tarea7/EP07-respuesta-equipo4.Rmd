---
title: "EP07-respuesta-equipo4"
output: html_document
date: "2024-10-29"
---

```{r setup, include=FALSE}
library(tidyverse)
library(ez)
library(ggpubr)
library(dplyr)
library(nlme)
library(emmeans)
```

## Enunciado Pregunta 1

Observando los datos, la memorista sospecha que hay diferencias significativas en el tiempo de ejecución entre las versiones B y C del algoritmo cuando las instancias tienen 65 o más nodos. ¿Los datos respaldan la intuición de la memorista?
Para responder, filtren los datos para tener las instancias con 65 o más nodos y seleccionen las columnas de los tiempos de ejecución de las versiones B y C en formato ancho. Usando como semilla el valor 73, obtenga muestras aleatorias independientes de 24 tiempos registrados por la versión B y 20 tiempos registrados por la versión C del algoritmo. Realicen un análisis estadístico pertinente (enunciar hipótesis, revisar condiciones, seleccionar pruebas ómnibus y post-hoc según corresponda) para responder la pregunta planteada, utilizando pruebas no paramétricas de ser necesario.

```{r}
# Obtención de datos
datos <- read.csv("EP07 Datos.csv")

datosP1 <- datos %>% filter(n.nodos > 65)

set.seed(73)

datosP1B <- sample(datosP1$tiempo.B, size = 24)
datosP1C <- sample(datosP1$tiempo.C, size = 20)

```

### Revisión de condiciones

Normalidad de las muestras:

```{r}

print(shapiro.test(datosP1$tiempo.B))

print(shapiro.test(datosP1$tiempo.C))
```
Al ver los resultados de las pruebas de Shapiro para todos los tiempos de las versiones B y C, es decir, de donde provienen las observaciones a estudiar, se puede observar que se obtienen valores p muy bajos, por lo cual se puede concluir que ninguna de las muestras proviene de una población que sigue una distribución cercana a la normal, por lo tanto se procederá a utilizar una prueba de suma de rangos de Wilcoxon y se utilizará un nivel de significancia de 0.05. Donde las hipótesis serán:


$H_0$ : No hay diferencias significativas en el tiempo de ejecución entre las versiones B y C del algoritmo cuando las instancias tienen 65 o más nodos.

$H_A$ : Si hay diferencias significativas en el tiempo de ejecución entre las versiones B y C del algoritmo cuando las instancias tienen 65 o más nodos.


1 - Independencia entre muestras:

Por el contexto y enunciado, se puede concluir que los datos entre cada muestra son independientes, puesto que provienen de distintas instancias de ejecución y en este caso el algoritmo usado entre muestras es distinto.

2 - La escala de medición es a lo menos ordinal:

Como la medición es en tiempo, medido en milisegundos, claramente tiene sentido hablar de orden entre las medidas.

### Prueba suma de rangos de Wilcoxon

```{r}
alfa <- 0.05

prueba <- wilcox.test(datosP1B, datosP1C, alternative = "two.sided", conf.level = 1 - alfa)

print(prueba)
```
Como el valor p obtenido por la prueba de suma de rangos de Wilcoxon es menor al nivel de significancia, se rechaza la hipótesis nula y con un 95% de confianza podemos decir que existe suficiente evidencia para afirmar que si hay diferencias significativas en el tiempo de ejecución entre las versiones B y C del algoritmo cuando las instancias tienen 65 o más nodos.

## Enunciado Pregunta 2

La memorista también sospecha que, al comparar las mismas instancias de iguales características, las mejores soluciones encontradas por las versiones A y B tienen rendimientos distintos. ¿Estará en lo cierto?
Para responder, filtren los datos para tener las instancias con 65 o más nodos y seleccionen las columnas con el mejor rendimiento de las versiones A y B en formato ancho. Usando como semilla el valor 13, obtengan una muestra aleatoria de 22 instancias. Realicen un análisis estadístico pertinente (enunciar hipótesis, revisar condiciones, seleccionar pruebas ómnibus y post-hoc según corresponda) para responder la pregunta planteada, utilizando pruebas no paramétricas de ser necesario.

```{r}
set.seed(13)

# Selección de 22 instancias con rendimiento de las versiones A y B
datosP2 <- datosP1 %>% select(instancia, mejor.A, mejor.B) %>% sample_n(22)

# Asignación de las columnas correctamente
datosP2A <- datosP2$mejor.A
datosP2B <- datosP2$mejor.B
```

## Revisión de condiciones

Normalidad de la diferencia entre muestras:

```{r}
datosDiffAB <- datosP2A - datosP2B

print(shapiro.test(datosDiffAB))
```
Al ver los resultados de la prueba de Shapiro para la diferencia entre los rendimientos del algoritmo A y B para cada instancia, se puede observar que se obtiene un valor p muy bajo, por lo cual se puede concluir la diferencia entre las observaciones apareadas no sigue una distribución normal, por lo tanto se procederá a utilizar una prueba de suma de rangos con signo de Wilcoxon y se utilizará un nivel de significancia de 0.05. Donde las hipótesis serán:

$H_0$ : No hay diferencias significativas en el rendimiento entre las versiones A y B del algoritmo cuando las instancias tienen 65 o más nodos.

$H_A$ : Si hay diferencias significativas en el rendimiento entre las versiones A y B del algoritmo cuando las instancias tienen 65 o más nodos.

1 - Independencia entre pares de observaciones:

Por el contexto y enunciado, se puede concluir que los pares de observaciones son independientes, puesto que provienen de distintas instancias de ejecución y ademas se usaran muestras aleatorias usando "sample".

2 - La escala de medición es a lo menos ordinal:

Como la medición en este caso es un porcentaje, medido entre un rango con intervalos entre 0 a 100, claramente tiene sentido hablar de orden entre las medidas.

```{r}
# Prueba de Wilcoxon pareada
prueba <- wilcox.test(datosP2A, datosP2B, paired = TRUE,
                     alternative = "two.sided", conf.level = 0.95)

print(prueba)
```
Como el valor p obtenido por la prueba de suma de rangos con signo de Wilcoxon es menor al nivel de significancia, se rechaza la hipótesis nula y con un 95% de confianza podemos decir que existe suficiente evidencia para afirmar que si hay diferencias significativas en el rendimiento entre las versiones A y B del algoritmo cuando las instancias tienen 65 o más nodos. 

## Enunciado Pregunta 3

La memorista sospecha que hay diferencias significativas en el tiempo de ejecución entre las versiones del algoritmo cuando las instancias de prueba tienen 50 o más nodos. ¿Los datos respaldan la intuición de la memorista?
Para responder, filtren los datos para tener las instancias con 50 o más nodos y seleccionen las columnas con los tiempos de ejecución registrados (en formato ancho). Usando como semilla el valor 31, obtengan muestras aleatorias independientes de 15, 14 y 13 tiempos registrados por las versiones A, B y C, respectivamente. Realicen un análisis estadístico pertinente (enunciar hipótesis, revisar condiciones, seleccionar pruebas ómnibus y post-hoc según corresponda) para responder la pregunta planteada, utilizando pruebas no paramétricas de ser necesario.

```{r}
# Filtrado de datos
datosP3 <- datos %>% filter(n.nodos > 50)

set.seed(31)

P3A <- sample(datosP3$tiempo.A, size = 15)
P3B <- sample(datosP3$tiempo.B, size = 14)
P3C <- sample(datosP3$tiempo.C, size = 13)

```

### Revisión de condiciones

Normalidad de las muestras:

```{r}
print(shapiro.test(datosP3$tiempo.A))

print(shapiro.test(datosP3$tiempo.B))

print(shapiro.test(datosP3$tiempo.C))
```
Al ver los resultados de las pruebas de Shapiro para todos los tiempos de las versiones A, B y C, es decir, de donde provienen las observaciones a estudiar, se puede observar que se obtienen valores p muy bajos, por lo cual se puede concluir que ninguna de las muestras proviene de una población que sigue una distribución cercana a la normal, por lo tanto se procederá a utilizar una prueba Kruskal-Wallis y se utilizará un nivel de significancia de 0.01. Donde las hipótesis serán:


$H_0$ : No hay diferencias significativas en el tiempo de ejecución entre cualquiera las versiones del algoritmo cuando las instancias tienen 50 o más nodos.

$H_A$ : Al menos una de las versiones del algoritmo presenta diferencias significativas en el tiempo de ejecución con respecto a al menos otra versión del algoritmo cuando las instancias tienen 50 o más nodos.

1 - Variable independiente tiene a lo menos 2 niveles:

Debido a que existen 3 versiones del algoritmo, se verifica la primera condición de la prueba porque son mas de 2 niveles.

2 - La escala de medición es a lo menos ordinal:

Como la medición es en tiempo, medido en milisegundos, claramente tiene sentido hablar de orden entre las medidas.

3 - Independencia entre muestras:

Por el contexto y enunciado, se puede concluir que los datos entre cada muestra son independientes, puesto que provienen de distintas instancias de ejecución y en este caso el algoritmo usado entre muestras es distinto.

```{r}
#Modificación de los datos necesaria para efectuar la prueba
TiempoP3 <- c(P3A, P3B, P3C)

VersionP3 <- c(rep("A", length(P3A)), rep("B", length(P3B)),
               rep("C", length(P3C)))
VersionP3 <- factor(VersionP3)

datosP3 <- data.frame(TiempoP3, VersionP3)

alfa <-0.01

# Prueba de Kruskal-Wallis

pruebaP3 <- kruskal.test(TiempoP3 ~ VersionP3, data = datosP3)
print(pruebaP3)
```

```{r}
# Procedimiento post-hoc de Benjamini & Hochberg
post_hocP3 <- pairwise.wilcox.test(datosP3[["TiempoP3"]],
                                   datosP3[["VersionP3"]],
                                   p.adjust.method = "BH",
                                   paired = FALSE,
                                   exact = FALSE)
print(post_hocP3)
```


## Enunciado Pregunta 4

La memorista también sospecha que, al comparar las mismas instancias con iguales características, las mejores soluciones encontradas por las diferentes versiones del algoritmo tienen rendimientos distintos. ¿Estará en lo cierto?
Para responder, filtren los datos para tener las instancias con 50 o más nodos y seleccionen las columnas con los mejores rendimientos registrados. Usando como semilla el valor 73, obtengan una muestra aleatoria de 22 instancias. Lleven los datos a formato largo y utilicen una prueba no paramétrica apropiada para analizar los datos obtenidos. Realicen un análisis estadístico pertinente (enunciar hipótesis, revisar condiciones, seleccionar pruebas ómnibus y post-hoc según corresponda) para responder la pregunta planteada, utilizando pruebas no paramétricas de ser necesario.

```{}
```